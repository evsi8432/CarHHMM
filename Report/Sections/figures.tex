% !TeX root = ../main.tex

%%% Tables %%%

\begin{table}[ht]
\centering
\caption{Estimates and standard errors of emission parameters for dive duration ($Y_t$), acceleration ($\Zone_{t,\tilde t^*}$), and wiggliness ($\Ztwo_{t,\tilde t^*}$) of the killer whale case study data under the full CarHHMM-DFT. The $\pm$ refers to the standard deviation of the parameter estimates for all 500 simulations.}
\scalebox{0.75}{
\begin{tabular}{ccccc}
    \multirow{2}{*}{Feature}                                                       & \multirow{2}{*}{Dive / Subdive Type} & \multicolumn{3}{c}{Parameter Estimate}                      \\
                                                                                   &                                      & $\hat \mu$          & $\hat \sigma$     & $\hat \phi$       \\ \hline
    \multirow{2}{*}{Dive Duration $(s)$ - $Y_t$}                                   & 1                                    & $25.68  \pm 0.60$   & $9.57 \pm 0.51$   & ---               \\
                                                                                   & 2                                    & $104.6  \pm 9.4$    & $64.7 \pm 7.5$    & ---               \\ \hline
    \multirow{3}{*}{X-Acceleration $(m/s^2)$ - $\left(\Zone_{t,\tilde t^*}\right)_x$}     & 1                                    & $0.020  \pm 0.042$  & $0.034 \pm 0.001$ & $0.976 \pm 0.007$ \\
                                                                                   & 2                                    & $0.244  \pm 0.013$  & $0.079 \pm 0.001$ & $0.886 \pm 0.005$ \\
                                                                                   & 3                                    & $0.218  \pm 0.028$  & $0.265 \pm 0.007$ & $0.626 \pm 0.029$ \\ \hline
    \multirow{3}{*}{Y-Acceleration $(m/s^2)$ - $\left(\Zone_{t,\tilde t^*}\right)_y$}     & 1                                    & $0.469  \pm 0.052$  & $0.044 \pm 0.001$ & $0.976 \pm 0.009$ \\
                                                                                   & 2                                    & $0.436  \pm 0.014$  & $0.082 \pm 0.001$ & $0.886 \pm 0.012$ \\
                                                                                   & 3                                    & $0.384  \pm 0.033$  & $0.321 \pm 0.009$ & $0.626 \pm 0.034$ \\ \hline
    \multirow{3}{*}{Z-Acceleration $(m/s^2)$ - $\left(\Zone_{t,\tilde t^*}\right)_z$}     & 1                                    & $-0.683 \pm 0.061$  & $0.052 \pm 0.001$ & $0.976 \pm 0.005$ \\
                                                                                   & 2                                    & $-0.593 \pm 0.016$  & $0.096 \pm 0.001$ & $0.886 \pm 0.009$ \\
                                                                                   & 3                                    & $-0.366 \pm 0.033$  & $0.317 \pm 0.009$ & $0.626 \pm 0.033$ \\ \hline
    \multirow{3}{*}{Wiggliness - $\Ztwo_{t,\tilde t^*}$}                                  & 1                                    & $23.34  \pm 0.29$   & $12.95 \pm 0.27$  & ---               \\
                                                                                   & 2                                    & $301.2  \pm 3.2$    & $330.1 \pm 4.2$   & ---               \\
                                                                                   & 3                                    & $10200  \pm 210$    & $15300 \pm 350$   & ---               \\ \hline
    \end{tabular}
    }
    \label{table:emis_dists_CarHHMM-DFT}
\end{table}

\begin{table}[ht]
\centering
\caption{Accuracies and run times for all models in the simulation study. All reported values are averages, and $\pm$ refers to the standard deviation across a total of 500 fitted models. Both training and test data sets are made up of 100 simulated dives. Rows labelled Both/Both correspond to overall model accuracy.}
\scalebox{0.75}{
\begin{tabular}{ccccccc}
Model                       & \multicolumn{1}{c}{Train Time (min)} & \multicolumn{1}{c}{True Dive Type} & \multicolumn{1}{c}{True Subdive State} & \multicolumn{1}{c}{Dive Accuracy} & \multicolumn{1}{c}{Subdive Accuracy}  \\ \hline
\multirow{5}{*}{CarHHMM-DFT}& \multirow{5}{*}{$150 \pm 37$}      & Both                          & Both                             & $0.94 \pm 0.03$                   & $1.00 \pm 0.00$                       \\
                            &                                    & 1                             & 1                                & \multirow{2}{*}{$0.93\pm0.04$}    & $1.00 \pm 0.00$                       \\ 
                            &                                    & 1                             & 2                                &                                   & $1.00 \pm 0.00$                       \\ 
                            &                                    & 2                             & 1                                & \multirow{2}{*}{$0.94\pm0.03$}    & $1.00 \pm 0.00$                       \\ 
                            &                                    & 2                             & 2                                &                                   & $1.00 \pm 0.00$                       \\ \hline
\multirow{5}{*}{HHMM-DFT}   & \multirow{5}{*}{$140 \pm 29$}      & Both                          & Both                             & $0.94 \pm 0.03$                   & $1.00 \pm 0.00$                       \\
                            &                                    & 1                             & 1                                & \multirow{2}{*}{$0.93\pm0.04$}    & $1.00 \pm 0.00$                       \\ 
                            &                                    & 1                             & 2                                &                                   & $1.00 \pm 0.00$                       \\ 
                            &                                    & 2                             & 1                                & \multirow{2}{*}{$0.94\pm0.03$}    & $1.00 \pm 0.00$                       \\ 
                            &                                    & 2                             & 2                                &                                   & $1.00 \pm 0.00$                       \\ \hline
\multirow{5}{*}{CarHHMM}    & \multirow{5}{*}{$258 \pm 82$}      & Both                          & Both                             & $0.87 \pm 0.11$                   & $0.89 \pm 0.01$                       \\
                            &                                    & 1                             & 1                                & \multirow{2}{*}{$0.79\pm0.23$}    & $0.43 \pm 0.08$                       \\ 
                            &                                    & 1                             & 2                                &                                   & $1.00 \pm 0.00$                       \\ 
                            &                                    & 2                             & 1                                & \multirow{2}{*}{$0.96\pm0.03$}    & $0.82 \pm 0.01$                       \\ 
                            &                                    & 2                             & 2                                &                                   & $1.00 \pm 0.00$                       \\ \hline
\multirow{5}{*}{CarHMM-DFT} & \multirow{5}{*}{$62 \pm 10$}       & Both                          & Both                             & -------------                     & $1.00 \pm 0.00$                       \\
                            &                                    & 1                             & 1                                & \multirow{2}{*}{-------------}    & $1.00 \pm 0.00$                       \\ 
                            &                                    & 1                             & 2                                &                                   & $1.00 \pm 0.00$                       \\ 
                            &                                    & 2                             & 1                                & \multirow{2}{*}{-------------}    & $1.00 \pm 0.00$                       \\ 
                            &                                    & 2                             & 2                                &                                   & $1.00 \pm 0.00$                       \\ \hline 
\end{tabular}
}
\label{table:accuracy}
\end{table}

%%% data %%%

\begin{figure}[ht]
	\centering
	\includegraphics[width=5.25in]{../Plots/raw_data.png}
	\caption{Dive depth (top panel) and acceleration (bottom three panels) as functions of time from a northern resident killer whale.}
	\label{fig:data}
\end{figure}

\begin{figure}[ht]
	\centering
	\includegraphics[width=5in]{../Plots/CarHHMM2_decoded_dives.png}
	\caption{The $x$-component of acceleration $\left(y^*_{t,t^*}\right)_x$ (top two panels) and dive profile (bottom two panels) of a northern resident killer whale for a sequence of six selected dives. The line colours in the first and third panels correspond to the estimated dive types while the line colours of the second and fourth panels correspond the estimated subdive states. Both the dive types and subdive states are estimated by fitting the CarHHMM-DFT to the data.}
	\label{fig:labeled_dives}
\end{figure}

%%% model definitions %%%

\begin{figure}[ht]
    \begin{subfigure}{\textwidth}
      \centering
      \includegraphics[width=4in]{../Plots/HMM.png}  
      \caption{Hidden Markov Model (\textbf{HMM})}
      \label{fig:HMM}
    \end{subfigure}
    %
    \newline
    %
    \begin{subfigure}{\textwidth}
      \centering
      \includegraphics[width=4in]{../Plots/CarHMM.png}  
      \caption{Conditionally Autoregressive HMM (\textbf{CarHMM})}
      \label{fig:CarHMM}
    \end{subfigure}
    %
    \newline
    %
    \begin{subfigure}{\textwidth}
      \centering
      \includegraphics[width=4in]{../Plots/HHMM.png}  
      \caption{Hierarchical HMM (\textbf{HHMM})}
      \label{fig:HHMM}
    \end{subfigure}
    %
    \newline
    %
    \begin{subfigure}{\textwidth}
      \centering
      \includegraphics[width=4in]{../Plots/HMM-DFT.png}  
      \caption{HMM with Discrete Fourier Transform (\textbf{HMM-DFT})}
      \label{fig:HMM-DFT}
    \end{subfigure}
    \caption{Dependence structures of HMM variants. Hidden state sequences are denoted as $X$ on the coarse-scale and $X^*$ at the fine scale. Observations (or emissions) are denoted by $Y$ on the coarse scale and $Y^*$ on the fine scale. Observations transformed using a moving window are denoted as $\Z$.}
    \label{fig:models}
\end{figure}

%%% Case Study %%%

\begin{figure}[ht]
	\centering
	\includegraphics[width=5in]{../Plots/CarHHMM-DFT.png}
	\caption{Graphical representation of the model used in the simulation and case study, the \textbf{CarHHMM-DFT}. The dive type of dive $t$ is denoted by $X_t$ and $Y_t$ represents the associated dive duration. The raw acceleration vector associated with dive $t$ and time stamp $t^*$ is denoted by $Y^*_{t,t^*}$. The subdive state of the killer whale during dive $t$ and window $\tilde t^*$ is denoted as $\tilde X^*_{t,\tilde t^*}$, and the corresponding transformed observations are denoted by $\Z_{t,\tilde t^*}$.}
	\label{fig:CarHHMM-DFT}
\end{figure}

\begin{figure}[ht]
	\centering
	\includegraphics[width=5in]{../Plots/CarHHMM2-coarse-emissions.png}
	\caption{Estimated probability densities of dive duration ($Y_t$) corresponding to dive type 1 (short dives) and dive type 2 (longer dives). These are Gamma densities and are fit using the CarHHMM-DFT and the killer whale case study data.}
	\label{fig:coarse_emis}
\end{figure}

\begin{figure}[ht]
	\centering
	\includegraphics[width=5in]{../Plots/CarHHMM2-fine-emissions.png}
	\caption{Estimated probability density of wiggliness ($\Ztwo_{t,\tilde t^*}$) and conditional density of acceleration ($\Zone_{t,\tilde t^*}|\Zone_{t,\tilde t^*-1} = \mu_A^{*(\cdot,i^*)}$) corresponding to subdive states $i^* = 1,2,3$ (see Table \ref{table:emis_dists_CarHHMM-DFT}). The estimated conditional density of acceleration is Normal and plotted on a linear scale while the estimated density of wiggliness is Gamma and plotted on a log-log scale for clarity.}
	\label{fig:fine_emis}
\end{figure}

\begin{figure}[ht]
    \begin{subfigure}{0.45\textwidth}
    	\centering
    	\includegraphics[width=2.25in]{../Plots/CarHHMM2_psedoresids_ahat.png}
    	\caption{Histogram of pseudoresiduals of $W^*_{t,\tilde t^*}$}
    	\label{fig:pseudoresids}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
    	\centering
    	\includegraphics[width=2.25in]{../Plots/CarHHMM2_empirical_hist_dive_duration.png}
    	\caption{Empirical distribution of $Y_t$}
    	\label{fig:empirical_dist}
    \end{subfigure}
    \caption{Pseudoresiduals of wiggliness ($\Ztwo_{t,\tilde t^*}$, left) plotted over a standard normal density as well as a weighted empirical distribution of dive duration ($Y_t$, right) plotted over the corresponding fitted Gamma distributions. Both plots are generated using the fitted CarHHMM-DFT and the killer whale case study data.}
    \label{fig:model_checking}
\end{figure}

%%% simulation study %%%

\begin{figure}[ht]
	\centering
	\includegraphics[width=5in]{../Plots/sim_data.png}
	\caption{Acceleration data for one dive of a selected simulated data set. The raw accelerometer data is denoted as $Y^*_{t,\tilde t^*}$ which is recorded at 50 hertz while $\Zone_{t,\tilde t^*}$ and $\Ztwo_{t,\tilde t^*}$ are recorded at 0.5 hertz. The colour of the line corresponds to the true fine-scale state, while the colour of the background corresponds to the true dive type.}
	\label{fig:sim_data}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=4.5in]{../Plots/Posterior_Coarse_States.png}
    \caption{Estimated probabilities that each dive is of type two for five selected dives of one simulated data set. The colour of the line corresponds to the true dive type while the colour of the background corresponds to the true subdive state. The CarHMM-DFT is omitted because it incorporates only one dive type.}
    \label{fig:acc_coarse}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=4.5in]{../Plots/Posterior_Fine_States.png}
    \caption{Estimated probabilities that each subdive segment is in state two for five selected dives of one simulated data set. The colour of the line corresponds to the true subdive state while the colour of the background corresponds to the true dive type.}
    \label{fig:acc_fine}
\end{figure}